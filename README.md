# IOConfigurator
IO-конфигуратор для систем управления двигателями (СУД) производства «Альянс Эко»

## Меню
* [Использование](#использование)
  * [Запуск](#запуск)
  * [Результат работы](#результат-работы)
* [Документация](#документация)
  * [Структура кода](#структура-кода)
    * [Парсинг параметров запуска](#парсинг-параметров-запуска)
    * [Парсинг IO-листа](#парсинг-IO-листа)
    * [Парсинг названий переменных](#парсинг-названий-переменных)
    * [Валидация данных](#валидация-данных)
    * [Подготовка данных](#подготовка-данных)
    * [Создание файлов с кодом](#создание-файлов-с-кодом)

## Использование

Для работы необходим python 3.10

### Запуск:
```
python.exe .\ioconfigurator\main.py -p "path\to\io list.xlsx" -pv "path\to\vars.xlsx" -e "A1 ШУ" "A2 ШУД" "A3 ШУ" -ai -ao -di -do -ex
```

параметры командной строки:
```
  -h, --help         Показать этот список
  -p (обязательный)  Путь до IO-лист.xlsx 
  -pv                Путь до IO-лист Поз_обозн-имя.xlsx
  -e [E ...]         Исключить из генерации указанные ПЛК (через пробел "ПЛК ШКАФ": -e "A1 ШУ" "A2 ШУД" "A3 ШУ") 
  -ai                Генерация AI
  -ao                Генерация AO
  -di                Генерация DI
  -do                Генерация DO
  -ex                Инициация исключений при ошибках вместо логгирования
  
  Примечание - Если не указать ни один из флагов (-ai -ao -di -do), то генерироваться будет всё
```

### Результат работы
В родительском каталоге указанного в параметре -p IO-листа, создаются 2 папки:
* _log (с логами работы io-конфигуратора)
* _code
  * [AI]
    * strAiClass.txt
    * methInit.txt
    * ...
  * [AO]
  * [DI]
  * [DO]

В папке _code создаются подкаталоги сгенерированных сигналов. В каждом подкаталоге генерируется *.txt файл с одной сущностью (структура, инициализация, обработка и т.д.)

## Документация
### Структура кода
* [Парсинг параметров запуска](#парсинг-параметров-запуска)
* [Парсинг IO-листа](#парсинг-IO-листа)
* [Парсинг названий переменных](#парсинг-названий-переменных)
* [Валидация данных](#валидация-данных)
* [Подготовка данных](#подготовка-данных)
* [Создание файлов с кодом](#создание-файлов-с-кодом)

#### Парсинг параметров запуска
#### Парсинг IO-листа
#### Парсинг названий переменных
#### Валидация данных
#### Подготовка данных
#### Создание файлов с кодом